<!DOCTYPE html>
<html lang="en"><head>
<script src="thesis-defense_files/libs/clipboard/clipboard.min.js"></script>
<script src="thesis-defense_files/libs/quarto-html/tabby.min.js"></script>
<script src="thesis-defense_files/libs/quarto-html/popper.min.js"></script>
<script src="thesis-defense_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="thesis-defense_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="thesis-defense_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="thesis-defense_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="thesis-defense_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.367">

  <meta name="author" content="Annika Helverson">
  <meta name="dcterms.date" content="2024-04-30">
  <title>A Hybrid Particle Filter for Simultaneous Parameter and State Estimation</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="thesis-defense_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="thesis-defense_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="thesis-defense_files/libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="thesis-defense_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="thesis-defense_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="thesis-defense_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="thesis-defense_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="thesis-defense_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="thesis-defense_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <meta name="mermaid-theme" content="default">
  <script src="thesis-defense_files/libs/quarto-diagram/mermaid.min.js"></script>
  <script src="thesis-defense_files/libs/quarto-diagram/mermaid-init.js"></script>
  <link href="thesis-defense_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">A Hybrid Particle Filter for Simultaneous Parameter and State Estimation</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Annika Helverson 
</div>
        <p class="quarto-title-affiliation">
            Department of Biostatistics, University of Iowa
          </p>
    </div>
</div>

  <p class="date">April 30, 2024</p>
</section>
<section id="scope-of-thesis" class="slide level2">
<h2>Scope of thesis</h2>
<p>This thesis consists of three components:</p>
<ol type="1">
<li><p>A computationally efficient algorithm for state space estimation</p></li>
<li><p>A software package in Julia for convenient implementation of our algorithm</p></li>
<li><p>A real data application to a cholera outbreak in Haiti</p></li>
</ol>
</section>
<section id="outline" class="slide level2">
<h2>Outline</h2>
<ol type="1">
<li>Motivation</li>
<li>Background</li>
<li>Nested Particle Filter<br>
</li>
<li>Hybrid Particle Filter</li>
<li>Simulation Study</li>
<li>Algorithm Speed</li>
<li>Application</li>
<li>Software</li>
<li>Discussion</li>
</ol>
</section>
<section id="motivation" class="slide level2">
<h2>Motivation</h2>
<p>Infectious disease modeling plays a pivotol role in understanding and predicting the impact of pathogens on public health, but developing effective models is challenging.</p>
<ul>
<li><p>It can be difficult to characterize how pathogens interact with their hosts and the environment.</p></li>
<li><p>Factors like heterogeneous host mobility patterns and immune responses complicate the disease dynamics.</p></li>
<li><p>The outcome of interest might not be directly observable.</p>
<ul>
<li>Unobserved outcome is called a <strong>latent state</strong></li>
</ul></li>
<li><p>Identifying a simplified yet reasonable representation of the underlying process can be an important step in modeling such a complex system.</p></li>
</ul>
</section>
<section id="state-space-models" class="slide level2">
<h2>State Space Models</h2>
<p>State space models relate latent states and their evolution to observed outcomes.</p>
<ul>
<li><p>These models have two fundamental components:</p>
<ol type="1">
<li><p>State transition equation <span class="math inline">\(x_t = f(x_{t-1}, \theta, \epsilon_t)\)</span></p>
<ul>
<li><p>Describes how a latent state evolves from <span class="math inline">\(x_{t-1}\)</span> to <span class="math inline">\(x_t\)</span></p></li>
<li><p><span class="math inline">\(\theta\)</span> are parameters, <span class="math inline">\(\epsilon_t\)</span> is process noise</p></li>
<li><p>Assumed to be a Markov process such that <span class="math inline">\(p(x_t | x_{t-1}, x_{t-2}, \dots, x_{0}) = p(x_t | x_{t-1})\)</span></p></li>
</ul></li>
<li><p>Observation equation <span class="math inline">\(y_t = g(x_t, \theta, \delta_t)\)</span></p>
<ul>
<li><p>Relates observed data <span class="math inline">\(y_t\)</span> to the latent state <span class="math inline">\(x_t\)</span></p></li>
<li><p><span class="math inline">\(\delta_t\)</span> is observation noise</p></li>
</ul></li>
</ol></li>
</ul>
</section>
<section id="compartmental-models" class="slide level2">
<h2>Compartmental Models</h2>
<p>The state transition equation can be represented by a compartmental model.</p>
<ul>
<li><p>Relevant disease stages (compartments) such as <strong>susceptible</strong> (S), <strong>infectious</strong> (I), <strong>exposed</strong> (E), and <strong>recovered</strong> or <strong>removed</strong> (R) are identified.</p></li>
<li><p>At each time point in an epidemic, every individual is classified into one disease stage.</p></li>
<li><p>The Markov transition process defines how individuals move between compartments.</p></li>
</ul>
<div class="cell" data-reveal="true" data-fig-width="5">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">
flowchart LR
classDef iowa color:#000000,fill:#FFCD00, stroke:#000000
  A((S)) --&gt; B((E))
  B --&gt; C((I))
  C --&gt; D((R))
  D --&gt; A

class A,B,C,D iowa
</pre>
</div>
</div>
</div>
</div>
</section>
<section id="problem-statement" class="slide level2">
<h2>Problem Statement</h2>
<div class="fragment semi-fade-out">
<p>In this context, there are two features to estimate:</p>
<ol type="1">
<li><p>The latent state.</p></li>
<li><p>Model parameters (e.g., infection rate, incubation period, etc.).</p></li>
</ol>
</div>
<div class="fragment">
<div class="fragment semi-fade-out">
<p>Simultaneous estimation of latent states and unknown parameters lacks a definitive resolution.</p>
<ul>
<li><p>Markov Chain Monte Carlo (MCMC) methods, while theoretically applicable, are inefficient and encounter convergence issues in practice.</p></li>
<li><p>A computationally efficient class of methods for latent state estimation are called <strong>particle filters</strong> but they rely on known parameters.</p></li>
</ul>
</div>
</div>
<div class="fragment">
<p>We propose a particle filter extension such that both latent states and model parameters can be estimated within one efficient algorithm.</p>
</div>
</section>
<section id="particle-filters" class="slide level2">
<h2>Particle Filters</h2>
<div class="iowa-note">
<div class="iowa-note-header">
<p><i class="fas fa-info-circle"></i> Bayes’ Theorem</p>
</div>
<div class="iowa-note-container">
<p><span class="math inline">\(\text{posterior} = \frac{\text{likelihood} \times \text{prior}}{\text{marginal likelihood}}\)</span></p>
</div>
</div>
<p>The goal of a particle filter is to estimate the posterior, <span class="math inline">\(p(x_t | y_{1:t})\)</span>, at each time <span class="math inline">\(t = 0, 1, \dots, T\)</span> using Bayes’ theorem:</p>
<p><span class="math display">\[p(x_t | y_{1:t}) = \frac{p(y_t | x_t) p(x_t | y_{1:t-1})}{\int p(y_t | x_t) p(x_t | y_{1:t-1})dx_t}\]</span></p>
<ul>
<li>Recursion is used to obtain a complete estimate of the form <span class="math inline">\(p(x_{0:t} | y_{1:t})\)</span></li>
</ul>
<div class="fragment fade-in">
<ul>
<li><p>If the system is both <strong>linear</strong> and <strong>Gaussian</strong> a Kalman filter can be used with no approximation.</p></li>
<li><p>However, an approximation is required for non-linear, non-Gaussian models.</p></li>
</ul>
</div>
<div class="fragment fade-in">
<ul>
<li><p>Use importance sampling to approximate the continuous pdf with a weighted sum of <span class="math inline">\(N_s\)</span> potential realizations of the true state.</p></li>
<li><p>Particle filter approximation: <span class="math inline">\(p(x_{0:t}| y_{1:t}) \approx \sum_{i=1}^{N_s} w_{t}^{i} \delta (x_{0:t} - x_{0:t}^i)\)</span></p></li>
<li><p>Importance density chosen such that <span class="math inline">\(q(x_{0:t}|y_{1:t}) = q(x_t | x_{0:t-1}, y_{1:t}) q(x_{0:t-1}|y_{1:t-1})\)</span></p></li>
<li><p>Samples are drawn from <span class="math inline">\(x_t^i \sim q(x_t| x_{0:t-1}, y_{1:t})\)</span></p></li>
<li><p>The set <span class="math inline">\(\{ w_t^i, x_{0:t}^i\}_{i=1}^{N_s}\)</span> contains <span class="math inline">\(N_s\)</span> samples, <span class="math inline">\(x_{0:t}^i\)</span> and their weights <span class="math inline">\(w_t^i\)</span>.</p></li>
<li><p>Obtain the full sample <span class="math inline">\(x^i_{0:t}\)</span> recursively by augmenting <span class="math inline">\(x_{0:t-1}^i\)</span> with <span class="math inline">\(x_t^i\)</span></p></li>
<li><p>Calculate weights with <span class="math inline">\(w_t^i = w_{t-1}^i \frac{p(y_t | x_t^i) p(x_t^i | x_{t-1}^i)}{q(x_t^i | x_{t-1}^i, y_t)}\)</span></p></li>
<li><p>The weights are then normalized so <span class="math inline">\(\sum_{i=1}^{N_s} w_t^i = 1\)</span></p></li>
</ul>
</div>
</section>
<section id="particle-filter-components" class="slide level2">
<h2>Particle Filter Components</h2>
<p>To carryout the approximation, particle filters require:</p>
<ol type="1">
<li><p>A process model <span class="math inline">\(f_t(x_{t-1}, u_{t})\)</span></p></li>
<li><p>A measurement model (likelihood) <span class="math inline">\(g_t(x_t, y_t, u_{t})\)</span></p></li>
</ol>
<div class="fragment">
<ul>
<li><p>Assumes <span class="math inline">\(x_{0:t}\)</span> is a Markov chain</p>
<ul>
<li><p><span class="math inline">\(p(x_t | x_{1:t-1}, y_{1:t-1}) = p(x_t | x_{t-1})\)</span></p></li>
<li><p><span class="math inline">\(p(y_t | x_{1:t}) = p(y_t | x_t)\)</span></p></li>
</ul></li>
</ul>
</div>
</section>
<section id="sequential-importance-sampling-sis" class="slide level2">
<h2>Sequential Importance Sampling (SIS)</h2>
<p>The basis of all particle filtering schemes is SIS:</p>
<div id="fig-539a35d47e664c97a50115a146a7f1bd-1" class="quarto-figure quarto-figure-center" height="350" width="700">
<figure class="quarto-float quarto-float-fig">
<div>
<img data-src="SIS.png" id="fig-539a35d47e664c97a50115a146a7f1bd-1" width="700" height="350">
</div>
</figure>
</div>
</section>
<section id="toy-demonstration" class="slide level2">
<h2>Toy Demonstration</h2>
<div id="fig-539a35d47e664c97a50115a146a7f1bd-2" class="quarto-figure quarto-figure-center" height="500" width="700">
<figure class="quarto-float quarto-float-fig">
<div>
<img data-src="particle_filter.gif" id="fig-539a35d47e664c97a50115a146a7f1bd-2" width="700" height="500">
</div>
</figure>
</div>
</section>
<section id="problems-with-particle-filters" class="slide level2">
<h2>Problems with Particle Filters</h2>
<p>Particle filters are widely used and well documented, but have some notable shortcomings including:</p>
<ol type="1">
<li>Particle degeneracy</li>
</ol>
<div class="fragment">
<ul>
<li>A solution is <strong>resampling</strong></li>
</ul>
</div>
<div class="fragment">
<ol start="2" type="1">
<li>Sample impoverishment</li>
</ol>
</div>
<div class="fragment">
<ul>
<li>A solution is <strong>roughening</strong></li>
</ul>
</div>
<div class="fragment">
<ol start="3" type="1">
<li>Assumes that parameters are both <em>static</em> and <em>known</em></li>
</ol>
</div>
<div class="fragment">
<ul>
<li>Ongoing challenge.</li>
</ul>
</div>
</section>
<section id="relevant-particle-filter-extensions" class="slide level2">
<h2>Relevant Particle Filter Extensions</h2>
<p><strong>Resample-Move</strong>: a two-step algorithm addressing both particle degeneracy and sample impoverishment.</p>
<ul>
<li><p>Step 1: Resample particles.</p></li>
<li><p>Step 2: Use a Markov transition kernel to move proposed states to new locations.</p></li>
</ul>
<div class="fragment">
<p><strong>The Nested Particle Filter</strong>: designed to approximate the posterior probability distribution of the fixed parameters in a state space model.</p>
<ul>
<li><p>Can jointly estimate a latent state and unknown parameters.</p></li>
<li><p>Uses two “layers” of filtering, one for the parameters and one for the latent state.</p></li>
<li><p>There are <span class="math inline">\(N \times M\)</span> particles. <span class="math inline">\(N\)</span> is the number of parameter vectors and <span class="math inline">\(M\)</span> is the number of state vectors for each of the <span class="math inline">\(N\)</span> parameter vectors.</p></li>
<li><p>Resampling occurs among each of the <span class="math inline">\(M\)</span> state estimates and again among each of the <span class="math inline">\(N\)</span> parameter vectors.</p></li>
<li><p>Uses only <span class="math inline">\(N\)</span> importance weights for <span class="math inline">\(N \times M\)</span> particles.</p></li>
</ul>
</div>
</section>
<section id="the-nested-particle-filter" class="slide level2">
<h2>The Nested Particle Filter</h2>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Notation</a></li><li><a href="#tabset-1-2">Algorithm</a></li><li><a href="#tabset-1-3">Assumptions</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<ul>
<li><span class="math inline">\(N\)</span> is the number of parameter vectors drawn.</li>
<li><span class="math inline">\(M\)</span> is the number of state estimates per parameter vector</li>
<li><span class="math inline">\(N \times M\)</span> is the total number of particles in the filter</li>
<li><span class="math inline">\(\{X_{t}\}_{t \geq 0}\)</span> is a random sequence called a state process</li>
<li><span class="math inline">\(\{x^{(i,j)}\}_{1 \leq i \leq N; \ 1\leq j \leq M}\)</span> are the state estimates</li>
<li><span class="math inline">\(\{Y_t\}_{t \geq 1}\)</span> is a random sequence called an observation process</li>
<li><span class="math inline">\(\{y_t\}_{t \geq 1}\)</span> is a specific observation record</li>
<li><span class="math inline">\(\Theta\)</span> is a random variable. If <span class="math inline">\(\Theta = \theta\)</span> the parameter is known.</li>
<li><span class="math inline">\(\epsilon\)</span> is the parameter jittering variance</li>
<li><span class="math inline">\(\{ \omega^{(i)} \}_{1 \leq i \leq N}\)</span> are the particle weights</li>
<li><span class="math inline">\(\pi_0(\cdot)\)</span> indicates a prior proposal distribution.</li>
<li><span class="math inline">\(g_{t, \theta}(y_t | x)\)</span> is the likelihood of <span class="math inline">\(x\)</span> (measurement function)</li>
<li><span class="math inline">\(p\)</span> is a constant that determines the jittering variance</li>
</ul>
</div>
<div id="tabset-1-2">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-3" class="quarto-figure quarto-figure-center" height="700" width="750">
<figure class="quarto-float quarto-float-fig">
<div>
<img data-src="nested-alg.png" id="fig-539a35d47e664c97a50115a146a7f1bd-3" width="750" height="700">
</div>
</figure>
</div>
</div>
<div id="tabset-1-3">
<ul>
<li><p>The optimal filter, one based on the proposal <span class="math inline">\(p(x_t | x_{t-1}, y_t)\)</span> is continuous with respect to the parameters <span class="math inline">\(\theta\)</span>.</p>
<ul>
<li>If <span class="math inline">\(\theta \approx \tilde{\theta}\)</span> then <span class="math inline">\(p(x_{t-1} | y_{1:t-1}, \theta) \approx p(x_{t-1} | y_{1:t-1}, \tilde{\theta})\)</span> and <span class="math inline">\(p(x_{t-1}, \theta | y_{1:t-1}) \approx p(x_{t-1}, \tilde{\theta} | y_{1:t-1})\)</span>.</li>
</ul></li>
<li><p><span class="math inline">\(\theta\)</span> can only take on values in compact set <span class="math inline">\(D_{\theta} \subset \mathbb{R}^{d_{\theta}}\)</span></p></li>
<li><p><span class="math inline">\(g_{t, \theta}(y_t|x)\)</span> (likelihood) must be uniformly bounded over the parameter space</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="parameter-jittering-justification" class="slide level2">
<h2>Parameter Jittering Justification</h2>
<div class="fragment semi-fade-out">
<p>The continuity assumption is required because of the parameter jittering step.</p>
<ul>
<li><p>Filter initialized with <span class="math inline">\(N\)</span> realizations of <span class="math inline">\(\theta\)</span>, <span class="math inline">\(\{ \theta_{0}^{(i)}\}_{1 \leq i \leq N}\)</span></p></li>
<li><p>The jitter perturbs each parameter with random noise generated from <span class="math inline">\(N(0, \epsilon)\)</span> where <span class="math inline">\(\epsilon \leq N^{\frac{1}{\frac{p + 2}{p}}}\)</span> at every time step yielding <span class="math inline">\(\{ \tilde{\theta}_{t}^{(i)}\}_{1 \leq i \leq N}\)</span></p></li>
<li><p>With the continuity assumption we argue that <span class="math inline">\(\{ \theta_{0}^{(i)}\}_{1 \leq i \leq N} \approx \{ \tilde{\theta}_{1}^{(i)}\}_{1 \leq i \leq N}\)</span> and subsequently <span class="math inline">\(\{ \theta_{t-1}^{(i)}\}_{1 \leq i \leq N} \approx \{ \tilde{\theta}_{t}^{(i)}\}_{1 \leq i \leq N}\)</span></p></li>
</ul>
</div>
<div class="fragment">
<p>This is necessary because the Markov transition, <span class="math inline">\(p(x_t^i|x_{t-1}^i)\)</span> implicitly conditions on the parameter value.</p>
<ul>
<li>If <span class="math inline">\(\{ \theta_{t-1}^{(i)}\}_{1 \leq i \leq N} \neq \{ \tilde{\theta}_{t}^{(i)}\}_{1 \leq i \leq N}\)</span>, the algorithm cannot be run recursively.</li>
</ul>
</div>
</section>
<section id="weights-for-nested-particle-filter" class="slide level2">
<h2>Weights for Nested Particle Filter</h2>
<p>Justification for the weighting scheme comes from the Balance Heuristic proposed by Veach and Guibas (1995).</p>
<ul>
<li><p>Let <span class="math inline">\(p_1, \dots, p_n\)</span> be importance sampling distributions.</p></li>
<li><p>Define <span class="math inline">\(c_i\)</span> as the proportion of samples drawn from <span class="math inline">\(p_i\)</span> where <span class="math inline">\(\sum_i c_i = 1\)</span>.</p></li>
<li><p>Each estimator is parameterized by a set of weighting functions <span class="math inline">\(w_1, \dots, w_n\)</span></p></li>
</ul>
<p>The combined estimator across all samples is:</p>
<p><span class="math display">\[F = \sum_{i=1}^n \frac{1}{n_i} \sum_{j=1}^{n_i} w_i(X_{i,j}) \frac{f(X_{i,j})}{p_i(X_{i, j})} \text{      where } X_{i,j} \text{ are indep. samples from } p_i\]</span></p>
<div class="fragment">
<p>If weights are calculated with</p>
<p><span class="math display">\[\hat{w}_i(x) = \frac{c_i p_i(x)}{\sum_j c_j p_j(x)}\]</span></p>
<p>The value of the combined estimator, <span class="math inline">\(F\)</span>, does not depend on <span class="math inline">\(i\)</span>.</p>
</div>
</section>
<section id="the-hybrid-particle-filter" class="slide level2">
<h2>The Hybrid Particle Filter</h2>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">Introduction</a></li><li><a href="#tabset-2-2">Notation</a></li><li><a href="#tabset-2-3">Algorithm</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<ul>
<li><p>The hybrid particle filter maintains the <span class="math inline">\(N \times M\)</span> structure of the nested particle filter.</p></li>
<li><p>The weights are extended from an <span class="math inline">\(N \times 1\)</span> vector to an <span class="math inline">\(N \times M\)</span> matrix.</p></li>
<li><p>Resampling is triggered only when the effective sample size drops below a resampling threshold.</p></li>
<li><p>Resample-move is implemented such that a Metropolis-Hastings moves step is applied to <span class="math inline">\(tt\%\)</span> of time points and <span class="math inline">\(pp\%\)</span> of particles.</p></li>
</ul>
</div>
<div id="tabset-2-2">
<ul>
<li><span class="math inline">\(N\)</span> is the number of parameter vectors drawn.</li>
<li><span class="math inline">\(M\)</span> is the number of state estimates per parameter vector</li>
<li><span class="math inline">\(N \times M\)</span> is the total number of particles in the filter</li>
<li><span class="math inline">\(\{X_{t}\}_{t \geq 0}\)</span> is a random sequence called a state process</li>
<li><span class="math inline">\(\{x^{(i,j)}\}_{1 \leq i \leq N; \ 1\leq j \leq M}\)</span> are the state estimates</li>
<li><span class="math inline">\(\{Y_t\}_{t \geq 1}\)</span> is a random sequence called an observation process</li>
<li><span class="math inline">\(\{y_t\}_{t \geq 1}\)</span> is a specific observation record</li>
<li><span class="math inline">\(\Theta\)</span> is a random variable. If <span class="math inline">\(\Theta = \theta\)</span> the parameter is known.</li>
<li><span class="math inline">\(\epsilon\)</span> is the parameter jittering variance</li>
<li><span class="math inline">\(\{ \omega^{(i, j)} \}_{1 \leq i \leq N; \ 1\leq j \leq M}\)</span> is the matrix of particle weights</li>
<li><span class="math inline">\(N_{eff}\)</span> is the effective sample size</li>
<li><span class="math inline">\(N_{threshold}\)</span> is the minimum effective sample size before resampling is triggered<br>
</li>
<li><span class="math inline">\(\pi_0(\cdot)\)</span> indicates a prior/initial proposal distribution.</li>
<li><span class="math inline">\(g_{t, \theta}(y_t | x)\)</span> is the likelihood of <span class="math inline">\(x\)</span> (measurement function)</li>
<li><span class="math inline">\(p\)</span> is a constant that determines the jittering variance</li>
</ul>
</div>
<div id="tabset-2-3">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-4" class="quarto-figure quarto-figure-center" height="890" width="790">
<figure class="quarto-float quarto-float-fig">
<div>
<img data-src="hybrid-alg.png" id="fig-539a35d47e664c97a50115a146a7f1bd-4" width="790" height="890">
</div>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="justification-for-the-hybrid-particle-filter" class="slide level2">
<h2>Justification for the Hybrid Particle Filter</h2>
<p>There are two fundamental differences between the Nested and Hybrid Particle Filters:</p>
<ol type="1">
<li><p>In the hybrid filter, resampling only occurs when the effective sample size is small enough. After resampling, a “move” step from resample-move is implemented.</p>
<ul>
<li>Well justified by Gilks and Berzuini (2001)</li>
</ul></li>
<li><p>In the hybrid filter, there is one weight for every particle <span class="math inline">\(N \times M\)</span></p>
<ul>
<li><p>Importance sampling can be applied when the importance distribution depends on both the sample index <span class="math inline">\((i)\)</span> and iteration index <span class="math inline">\((t)\)</span> (Cappé et al., 2004).</p></li>
<li><p>This allows <span class="math inline">\(w_t^{(i)} \propto \frac{p(x_{0:t}^{(i)} | y_{1:t})}{q_{it}(x_{0:t}^{(i)} | y_{1:t})}\)</span></p></li>
</ul></li>
</ol>
</section>
<section id="simulation-study-single-location" class="slide level2">
<h2>Simulation Study (Single Location)</h2>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">Model</a></li><li><a href="#tabset-3-2">Simulated Epidemic</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<ul>
<li><p>Chain-binomial SEIR model with three parameters: <span class="math inline">\(\beta\)</span> (transmission rate), <span class="math inline">\(\sigma\)</span> (incubation rate), and <span class="math inline">\(\gamma\)</span> (recovery rate).</p></li>
<li><p>Let <span class="math inline">\(N_S\)</span>, <span class="math inline">\(N_E\)</span>, <span class="math inline">\(N_I\)</span>, and <span class="math inline">\(N_R\)</span> denote the number of people occupying the S, E, I, and R compartments respectively</p></li>
<li><p><span class="math inline">\(N_p = N_S + N_E + N_I + N_R = 60,000\)</span></p></li>
</ul>
<p><span class="math display">\[S \rightarrow E \sim Binomial(N_S, 1 - exp\{-\beta * I / N_p \})\]</span> <span class="math display">\[E \rightarrow I \sim Binomial(N_E, 1 - exp\{ -\sigma\})\]</span> <span class="math display">\[I \rightarrow R \sim Binomial(N_I, 1 - exp\{ -\gamma \})\]</span></p>
<ul>
<li><p>True parameters: <span class="math inline">\(\beta = 0.2\)</span>, <span class="math inline">\(\sigma = 0.2\)</span>, and <span class="math inline">\(\gamma = 0.1\)</span></p></li>
<li><p>Observations are under-reported cases from <span class="math inline">\(Poisson(\text{rate} = 0.5 * \lambda)\)</span></p></li>
</ul>
</div>
<div id="tabset-3-2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="sim1loc.png" width="800" height="300"></p>
<figcaption>Simulated single location epidemic in a population of 60,000 people over 365 days. (A) Simulated true case counts and observed case counts. (B) Simulated counts in each of the four compartments: S, E, I, and R.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="simulation-study-conditions" class="slide level2">
<h2>Simulation Study Conditions</h2>
<p>For both Hybrid and Nested Particle Filters, we vary the number of particles and the priors/initial proposals.</p>
<ul>
<li><p>Number of particles</p>
<ul>
<li><p><span class="math inline">\(N = M = 10\)</span> (<span class="math inline">\(N \times M = 100\)</span>)</p></li>
<li><p><span class="math inline">\(N = M = 30\)</span> (<span class="math inline">\(N \times M = 900\)</span>)</p></li>
<li><p><span class="math inline">\(N = M = 50\)</span> (<span class="math inline">\(N \times M = 2500\)</span>)</p></li>
</ul></li>
<li><p>Priors/Initial Proposals</p>
<ul>
<li><p>Strongly Informative:</p>
<ul>
<li><p><span class="math inline">\(\pi(\beta) \sim Normal(0.2, 0.01)\)</span></p></li>
<li><p><span class="math inline">\(\pi(\sigma) \sim Normal(0.2, 0.01)\)</span></p></li>
<li><p><span class="math inline">\(\pi(\gamma) \sim Normal(0.1, 0.01)\)</span></p></li>
</ul></li>
<li><p>Weakly Informative</p>
<ul>
<li><p><span class="math inline">\(\pi(\beta) \sim Gamma(4, 0.05)\)</span></p></li>
<li><p><span class="math inline">\(\pi(\sigma) \sim Gamma(4, 0.05)\)</span></p></li>
<li><p><span class="math inline">\(\pi(\gamma) \sim Gamma(4, 0.05)\)</span></p></li>
</ul></li>
<li><p>Flat</p>
<ul>
<li><p><span class="math inline">\(\pi(\beta) \sim Uniform(0, 0.5)\)</span></p></li>
<li><p><span class="math inline">\(\pi(\sigma) \sim Uniform(0, 0.5)\)</span></p></li>
<li><p><span class="math inline">\(\pi(\gamma) \sim Uniform(0, 0.5)\)</span></p></li>
</ul></li>
</ul>
<p>. . .</p>
<div id="fig-539a35d47e664c97a50115a146a7f1bd-5" class="absolute quarto-figure quarto-figure-center" data-top="250" width="500" height="400" data-right="50" style="top: 250px; right: 50px; width: 500px; height: 400px; ">
<figure class="quarto-float quarto-float-fig">
<div>
<img data-src="priors.png" id="fig-539a35d47e664c97a50115a146a7f1bd-5" class="absolute" style="top: 250px; right: 50px; width: 500px; height: 400px; ">
</div>
</figure>
</div></li>
</ul>
</section>
<section id="results-strongly-informative" class="slide level2">
<h2>Results: Strongly Informative</h2>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1">I</a></li><li><a href="#tabset-4-2"><span class="math inline">\(\beta\)</span></a></li><li><a href="#tabset-4-3"><span class="math inline">\(\sigma\)</span></a></li><li><a href="#tabset-4-4"><span class="math inline">\(\gamma\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<div id="fig-1loc-I" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-1loc-I-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-I" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-nested-I" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-nested-I-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="nested/Iest_n1l.png" style="width:50.0%" data-ref-parent="fig-1loc-I">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-nested-I-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Nested Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-I" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-hybrid-I" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-hybrid-I-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="hybrid/Iest_h1l.png" style="width:50.0%" data-ref-parent="fig-1loc-I">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-hybrid-I-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Hybrid Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-1loc-I-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Estimated infectious counts (I) using the Nested and Hybrid Particle Filters with strongly informative priors/initial proposals.
</figcaption>
</figure>
</div>
</div>
<div id="tabset-4-2">
<div id="fig-1loc-beta" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-1loc-beta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-beta" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-nested-beta" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-nested-beta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="nested/betaEst_n1l.png" style="width:50.0%" data-ref-parent="fig-1loc-beta">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-nested-beta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Nested Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-beta" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-hybrid-beta" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-hybrid-beta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="hybrid/betaEst_h1l.png" style="width:50.0%" data-ref-parent="fig-1loc-beta">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-hybrid-beta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Hybrid Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-1loc-beta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Estimated transmission rate (β) using the Nested and Hybrid Particle Filters with strongly informative priors/initial proposals.
</figcaption>
</figure>
</div>
</div>
<div id="tabset-4-3">
<div id="fig-1loc-sigma" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-1loc-sigma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-sigma" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-nested-sigma" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-nested-sigma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="nested/sigmaEst_n1l.png" style="width:50.0%" data-ref-parent="fig-1loc-sigma">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-nested-sigma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Nested Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-sigma" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-hybrid-sigma" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-hybrid-sigma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="hybrid/sigmaEst_h1l.png" style="width:50.0%" data-ref-parent="fig-1loc-sigma">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-hybrid-sigma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Hybrid Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-1loc-sigma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Estimated incubation rate (<span class="math inline">\(\sigma\)</span>) using the Nested and Hybrid Particle Filters with strongly informative priors/initial proposals.
</figcaption>
</figure>
</div>
</div>
<div id="tabset-4-4">
<div id="fig-1loc-gamma" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-1loc-gamma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-gamma" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-nested-gamma" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-nested-gamma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="nested/gammaEst_n1l.png" style="width:50.0%" data-ref-parent="fig-1loc-gamma">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-nested-gamma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Nested Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-gamma" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-hybrid-gamma" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-hybrid-gamma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="hybrid/gammaEst_h1l.png" style="width:50.0%" data-ref-parent="fig-1loc-gamma">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-hybrid-gamma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Hybrid Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-1loc-gamma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Estimated recovery rate (<span class="math inline">\(\gamma\)</span>) using the Nested and Hybrid Particle Filters with strongly informative priors/initial proposals.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="results-flat" class="slide level2">
<h2>Results: Flat</h2>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-5-1">I</a></li><li><a href="#tabset-5-2"><span class="math inline">\(\beta\)</span></a></li><li><a href="#tabset-5-3"><span class="math inline">\(\sigma\)</span></a></li><li><a href="#tabset-5-4"><span class="math inline">\(\gamma\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-5-1">
<div id="fig-1loc-I-unif" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-1loc-I-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-I-unif" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-nested-I-unif" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-nested-I-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="nested/Unif_Iest_n1l.png" style="width:50.0%" data-ref-parent="fig-1loc-I-unif">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-nested-I-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Nested Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-I-unif" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-hybrid-I-unif" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-hybrid-I-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="hybrid/Unif_Iest_h1l.png" style="width:50.0%" data-ref-parent="fig-1loc-I-unif">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-hybrid-I-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Hybrid Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-1loc-I-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Estimated infectious counts (I) using the Nested and Hybrid Particle Filters with flat priors/initial proposals.
</figcaption>
</figure>
</div>
</div>
<div id="tabset-5-2">
<div id="fig-1loc-beta-unif" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-1loc-beta-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-beta-unif" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-nested-beta-unif" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-nested-beta-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="nested/Unif_betaEst_n1l.png" style="width:50.0%" data-ref-parent="fig-1loc-beta-unif">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-nested-beta-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Nested Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-beta-unif" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-hybrid-beta-unif" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-hybrid-beta-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="hybrid/Unif_betaEst_h1l.png" style="width:50.0%" data-ref-parent="fig-1loc-beta-unif">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-hybrid-beta-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Hybrid Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-1loc-beta-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Estimated transmission rate (β) using the Nested and Hybrid Particle Filters with flat priors/initial proposals.
</figcaption>
</figure>
</div>
</div>
<div id="tabset-5-3">
<div id="fig-1loc-sigma-unif" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-1loc-sigma-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-sigma-unif" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-nested-sigma-unif" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-nested-sigma-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="nested/Unif_sigmaEst_n1l.png" style="width:50.0%" data-ref-parent="fig-1loc-sigma-unif">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-nested-sigma-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Nested Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-sigma-unif" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-hybrid-sigma-unif" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-hybrid-sigma-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="hybrid/Unif_sigmaEst_h1l.png" style="width:50.0%" data-ref-parent="fig-1loc-sigma-unif">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-hybrid-sigma-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Hybrid Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-1loc-sigma-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Estimated incubation rate (<span class="math inline">\(\sigma\)</span>) using the Nested and Hybrid Particle Filters with flat priors/initial proposals.
</figcaption>
</figure>
</div>
</div>
<div id="tabset-5-4">
<div id="fig-1loc-gamma-unif" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-1loc-gamma-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-gamma-unif" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-nested-gamma-unif" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-nested-gamma-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="nested/Unif_gammaEst_n1l.png" style="width:50.0%" data-ref-parent="fig-1loc-gamma-unif">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-nested-gamma-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Nested Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-gamma-unif" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-hybrid-gamma-unif" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-hybrid-gamma-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="hybrid/Unif_gammaEst_h1l.png" style="width:50.0%" data-ref-parent="fig-1loc-gamma-unif">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-hybrid-gamma-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Hybrid Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-1loc-gamma-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Estimated recovery rate (<span class="math inline">\(\gamma\)</span>) using the Nested and Hybrid Particle Filters with flat priors/initial proposals.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="results-weakly-informative" class="slide level2">
<h2>Results: Weakly Informative</h2>
<div class="panel-tabset">
<ul id="tabset-6" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-6-1">I</a></li><li><a href="#tabset-6-2"><span class="math inline">\(\beta\)</span></a></li><li><a href="#tabset-6-3"><span class="math inline">\(\sigma\)</span></a></li><li><a href="#tabset-6-4"><span class="math inline">\(\gamma\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-6-1">
<div id="fig-1loc-I-weak" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-1loc-I-weak-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-I-weak" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-nested-I-gam" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-nested-I-gam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="nested/gam8_Iest_n1l.png" style="width:50.0%" data-ref-parent="fig-1loc-I-weak">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-nested-I-gam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Nested Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-I-weak" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-hybrid-I-gam" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-hybrid-I-gam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="hybrid/gam8_Iest_h1l.png" style="width:50.0%" data-ref-parent="fig-1loc-I-weak">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-hybrid-I-gam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Hybrid Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-1loc-I-weak-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Estimated infectious counts (I) using the Nested and Hybrid Particle Filters with weakly informative priors/initial proposals.
</figcaption>
</figure>
</div>
</div>
<div id="tabset-6-2">
<div id="fig-1loc-beta-unif" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-1loc-beta-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-beta-unif" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-nested-beta-gam" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-nested-beta-gam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="nested/gam8_betaEst_n1l.png" style="width:50.0%" data-ref-parent="fig-1loc-beta-unif">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-nested-beta-gam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Nested Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-beta-unif" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-hybrid-beta-gam" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-hybrid-beta-gam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="hybrid/gam8_betaEst_h1l.png" style="width:50.0%" data-ref-parent="fig-1loc-beta-unif">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-hybrid-beta-gam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Hybrid Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-1loc-beta-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Estimated transmission rate (β) using the Nested and Hybrid Particle Filters with weakly informative priors/initial proposals.
</figcaption>
</figure>
</div>
</div>
<div id="tabset-6-3">
<div id="fig-1loc-sigma-unif" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-1loc-sigma-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-sigma-unif" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-nested-sigma-gam" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-nested-sigma-gam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="nested/gam8_sigmaEst_n1l.png" style="width:50.0%" data-ref-parent="fig-1loc-sigma-unif">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-nested-sigma-gam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Nested Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-sigma-unif" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-hybrid-sigma-gam" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-hybrid-sigma-gam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="hybrid/gam8_sigmaEst_h1l.png" style="width:50.0%" data-ref-parent="fig-1loc-sigma-unif">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-hybrid-sigma-gam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Hybrid Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-1loc-sigma-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Estimated incubation rate (<span class="math inline">\(\sigma\)</span>) using the Nested and Hybrid Particle Filters with weakly informative priors/initial proposals.
</figcaption>
</figure>
</div>
</div>
<div id="tabset-6-4">
<div id="fig-1loc-gamma-unif" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-1loc-gamma-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-gamma-unif" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-nested-gamma-gam" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-nested-gamma-gam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="nested/gam8_gammaEst_n1l.png" style="width:50.0%" data-ref-parent="fig-1loc-gamma-unif">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-nested-gamma-gam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Nested Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-1loc-gamma-unif" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-hybrid-gamma-gam" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-hybrid-gamma-gam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="hybrid/gam8_gammaEst_h1l.png" style="width:50.0%" data-ref-parent="fig-1loc-gamma-unif">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-hybrid-gamma-gam-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Hybrid Particle Filter
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-1loc-gamma-unif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Estimated recovery rate (<span class="math inline">\(\gamma\)</span>) using the Nested and Hybrid Particle Filters with weakly informative priors/initial proposals.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="simulation-summary" class="slide level2">
<h2>Simulation Summary</h2>
<div id="fig-539a35d47e664c97a50115a146a7f1bd-6" class="quarto-figure quarto-figure-center" height="850" width="600">
<figure class="quarto-float quarto-float-fig">
<div>
<img data-src="MSE_1loc.png" id="fig-539a35d47e664c97a50115a146a7f1bd-6" width="600" height="850">
</div>
</figure>
</div>
</section>
<section id="simulation-discussion" class="slide level2">
<h2>Simulation Discussion</h2>
<ul>
<li><p>With strongly informative priors/initial proposals, both methods estimate parameters well but the Nested approach struggled with state estimation.</p></li>
<li><p>With flat priors/initial proposals, both methods struggled but the Nested approach was better able to estimate parameters.</p></li>
<li><p>With weakly informative priors/initial proposals, both methods were able to estimate parameters but the Nested approach struggled to estimate the latent state.</p></li>
<li><p>Similar results in our multiple location simulation study.</p></li>
<li><p>Exploration of the parameter space is limited to small perturbations of <span class="math inline">\(\theta\)</span>. If the initial parameter values do not adequately cover the region around the true parameter values, it is reasonable to believe that parameter perturbations will not be sufficient in moving the parameters to the true value.</p></li>
</ul>
</section>
<section id="speed-comparison" class="slide level2">
<h2>Speed Comparison</h2>
<div class="panel-tabset">
<ul id="tabset-7" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-7-1">Setup</a></li><li><a href="#tabset-7-2">Model</a></li><li><a href="#tabset-7-3">Results</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1">
<ul>
<li><p>We compared the time required to conduct estimation (clock time) with the Hybrid and Nested Particle Filters as well as an MCMC approach.</p></li>
<li><p>In order to reach convergence with MCMC we were limited to a simple, single location SIR model with two parameters.</p></li>
<li><p>Effective sample size (ESS) is not compared because a single measure of ESS for a particle filter is not attainable.</p></li>
<li><p>All timing was done with the BenchmarkTools.jl package and all algorithms were tested using Julia 1.10.0 on an Mac with Apple M1 CPU (3.2GHz) with 8 GB memory.</p></li>
</ul>
</div>
<div id="tabset-7-2">
<p>Chain binomial SIR model:</p>
<p><span class="math display">\[\frac{dS}{dt} = -S * (\frac{\beta}{N_p} * I)\]</span></p>
<p><span class="math display">\[\frac{dI}{dt} = S * (\frac{\beta}{N_p} * I) - \lambda * I\]</span></p>
<p><span class="math display">\[\frac{dR}{dt} = \lambda * I\]</span></p>
<ul>
<li><p>60,000 people</p></li>
<li><p><span class="math inline">\(\beta \sim Uniform(0, 1)\)</span>, with true value 0.01</p></li>
<li><p><span class="math inline">\(\lambda \sim Uniform(0, 1)\)</span> with true value 0.01</p></li>
</ul>
</div>
<div id="tabset-7-3">
<table>
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th><strong>T</strong></th>
<th><strong>N</strong></th>
<th><strong>M</strong></th>
<th><strong>Hybrid PF Runtime</strong></th>
<th><strong>Nested PF Runtime</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>365</td>
<td>10</td>
<td>10</td>
<td>&gt; 1 second</td>
<td>&gt; 1 second</td>
</tr>
<tr class="even">
<td>365</td>
<td>50</td>
<td>50</td>
<td>18 seconds</td>
<td>15 seconds</td>
</tr>
<tr class="odd">
<td>365</td>
<td>100</td>
<td>100</td>
<td>126 seconds</td>
<td>260 seconds</td>
</tr>
<tr class="even">
<td>365</td>
<td>10</td>
<td>50</td>
<td>3 seconds</td>
<td>3 seconds</td>
</tr>
<tr class="odd">
<td>365</td>
<td>50</td>
<td>10</td>
<td>3 seconds</td>
<td>3 seconds</td>
</tr>
<tr class="even">
<td>365</td>
<td>10</td>
<td>100</td>
<td>7 seconds</td>
<td>6 seconds</td>
</tr>
<tr class="odd">
<td>365</td>
<td>100</td>
<td>10</td>
<td>7 seconds</td>
<td>6 seconds</td>
</tr>
<tr class="even">
<td>100</td>
<td>10</td>
<td>10</td>
<td>&gt; 1 second</td>
<td>&gt; 1 second</td>
</tr>
<tr class="odd">
<td>100</td>
<td>50</td>
<td>50</td>
<td>7 seconds</td>
<td>4 seconds</td>
</tr>
<tr class="even">
<td>100</td>
<td>100</td>
<td>100</td>
<td>33 seconds</td>
<td>16 seconds</td>
</tr>
<tr class="odd">
<td>100</td>
<td>10</td>
<td>50</td>
<td>1 second</td>
<td>&gt; 1 second</td>
</tr>
<tr class="even">
<td>100</td>
<td>50</td>
<td>10</td>
<td>1 second</td>
<td>&gt; 1 second</td>
</tr>
<tr class="odd">
<td>100</td>
<td>10</td>
<td>100</td>
<td>2 seconds</td>
<td>2 seconds</td>
</tr>
<tr class="even">
<td>100</td>
<td>100</td>
<td>10</td>
<td>2 seconds</td>
<td>1 second</td>
</tr>
</tbody>
</table>
<ul>
<li>An MCMC approach using NUTS in Turing.jl with four chains for a 365 time point epidemic ran for 43398 seconds (12 hours, 3 minutes, 18 seconds) before converging.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="application-cholera-outbreak" class="slide level2">
<h2>Application: Cholera Outbreak</h2>
<p>We consider a 103 week cholera outbreak in Haiti from 2010 through 2012.</p>
<ul>
<li><p>Cholera is an acute infection caused by the bacterium <em>Vibrio cholerae</em> (<em>V. cholerae</em>) which can result in severe diarrhea.</p></li>
<li><p><em>V. cholerae</em> is usually ingested via contaminated food or water and introduced back into the environment through contaminated fecal matter.</p>
<ul>
<li>Known for surviving for long periods of time in fresh, salty, and brackish water.</li>
</ul></li>
</ul>
<div class="fragment">
<ul>
<li><p>We aim to capture the bacterial spread though Haiti’s waterways with political borders and rainfall data.</p>
<ul>
<li>We do not have data on the size and location of actual waterways or sewage systems.</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>We devised a fully stochastic, spatial, chain binomial Susceptible- Infected-Recovered-Deceased (SIRD) model to estimate weekly cholera case counts in Haiti.</li>
</ul>
</div>
</section>
<section id="spatial-locations" class="slide level2">
<h2>Spatial Locations</h2>
<p>Haiti is divided into 10 departments:</p>
<div id="fig-539a35d47e664c97a50115a146a7f1bd-7" class="quarto-figure quarto-figure-center" height="500" width="700">
<figure class="quarto-float quarto-float-fig">
<div>
<img data-src="haiti_map.jpg" id="fig-539a35d47e664c97a50115a146a7f1bd-7" width="700" height="500">
</div>
</figure>
</div>
</section>
<section id="data" class="slide level2">
<h2>Data</h2>
<p>The observed data are weakly reported case counts in each of Haiti’s 10 departments.</p>
<div id="fig-haiti-dat" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-haiti-dat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-haiti-dat" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-large-epdi" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-large-epdi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="epid-large.png" data-ref-parent="fig-haiti-dat" height="300">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-large-epdi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Larger Outbreaks
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-haiti-dat" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-large-epdi" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-large-epdi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="epid-small.png" data-ref-parent="fig-haiti-dat" height="300">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-large-epdi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Smaller Outbreaks
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-haiti-dat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Observed cholera case counts across Haiti from October 17, 2010 to September 30, 2012
</figcaption>
</figure>
</div>
<ul>
<li>Additionally, weekly rainfall estimates in each department are reported.</li>
</ul>
</section>
<section id="concentration-of-v.-cholerae" class="slide level2">
<h2>Concentration of <em>V. cholerae</em></h2>
<div class="panel-tabset">
<ul id="tabset-8" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-8-1">Mechanism</a></li><li><a href="#tabset-8-2">Estimates</a></li><li><a href="#tabset-8-3">Discussion</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1">
<p>The primary driver of the epidemic is the environmental concentration of <em>V. cholerae</em> at each location (<span class="math inline">\(B_{(l)}(t)\)</span>).</p>
<p>There are two mechanisms through which <span class="math inline">\(B_{(l)}(t)\)</span> changes over time:</p>
<ol type="1">
<li><p>Natural death.</p></li>
<li><p>Infected individuals release contaminated fecal matter, dispersed via rainwater, into the environment.</p></li>
</ol>
<div class="fragment fade-in">
<p><span class="math display">\[\frac{d B_{(l)}}{d t} = - (\mu_B \times B_{(l)}(t)) + (\frac{1}{h_{(l)}} \times (1 + r_{(l)}(t)) \times I_{(l)}(t))\]</span></p>
</div>
</div>
<div id="tabset-8-2">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Best_all.png"></p>
<figcaption>Concentration of <em>V. cholerae</em> in each of Haiti’s 10 departments over the 103 week epidemic. Median concentration estimate (blue line) and 5th-95th percentile bounds (shaded region).</figcaption>
</figure>
</div>
</div>
<div id="tabset-8-3">
<p>The estimated concentration of <em>V. cholerae</em> in the environment decreases over the course of the epidemic in all 10 departments.</p>
<ul>
<li><p>Consistent with the empirical data showing a decline in reported cases overtime.</p></li>
<li><p>Near the end of the surveillance period when reported cases were low, the estimated concentration of <em>V. cholerae</em> is similar in all ten of Haiti’s departments.</p>
<ul>
<li>This is consistent with the reports of underlying levels of contaminants in public water sources in countries that lack adequate sewage treatment systems (Tibbetts, 2000).</li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
<section id="software" class="slide level2">
<h2>Software</h2>
<p>We developed a software package in Julia to implement the Hybrid Particle Filter for compartmental models.</p>
<ul>
<li><p>The package also implements the Nested Particle Filter.</p></li>
<li><p>Any compartmental model structure can be specified.</p></li>
<li><p>Supports stochastic and deterministic transition equations.</p></li>
<li><p>Written entirely in Julia.</p>
<ul>
<li>Highly customizeable.</li>
</ul></li>
<li><p>Handles simulation and estimation.</p></li>
</ul>
</section>
<section id="composite-types" class="slide level2">
<h2>Composite Types</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="composite-types.png" width="550" height="450"></p>
<figcaption>Composite types and convenience functions in HybridParticleFilter.jl. Rectanges indicate custom types whereas diamonds indicate convenience functions.</figcaption>
</figure>
</div>
</section>
<section id="post-processing" class="slide level2">
<h2>Post-Processing</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="post-funcs.png" width="450" height="500"></p>
<figcaption>Post-processing functions available in HybridParticleFilter.jl. Diamonds indicate functions and rectangles indicate output.</figcaption>
</figure>
</div>
</section>
<section id="code-demonstration" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Code Demonstration</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource julia number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode julia hljs"><span id="cb1-1" class="hljs-ln-code"><a href="#cb1-1"></a>Nt <span class="op">=</span> <span class="fl">365</span></span>
<span id="cb1-2" class="hljs-ln-code"><a href="#cb1-2"></a>Nloc <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb1-3" class="hljs-ln-code"><a href="#cb1-3"></a>N <span class="op">=</span> <span class="fl">50</span></span>
<span id="cb1-4" class="hljs-ln-code"><a href="#cb1-4"></a>M <span class="op">=</span> <span class="fl">50</span></span>
<span id="cb1-5" class="hljs-ln-code"><a href="#cb1-5"></a>p <span class="op">=</span> <span class="fl">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="code-demonstration-simulating-data" class="slide level2" data-auto-animate="true" data-visibility="uncounted">
<h2 data-id="quarto-animate-title">Code Demonstration: Simulating Data</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource julia number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode julia hljs"><span id="cb2-1" class="hljs-ln-code"><a href="#cb2-1"></a>Nt <span class="op">=</span> <span class="fl">365</span></span>
<span id="cb2-2" class="hljs-ln-code"><a href="#cb2-2"></a>Nloc <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb2-3" class="hljs-ln-code"><a href="#cb2-3"></a>N <span class="op">=</span> <span class="fl">50</span></span>
<span id="cb2-4" class="hljs-ln-code"><a href="#cb2-4"></a>M <span class="op">=</span> <span class="fl">50</span></span>
<span id="cb2-5" class="hljs-ln-code"><a href="#cb2-5"></a>p <span class="op">=</span> <span class="fl">3</span></span>
<span id="cb2-6" class="hljs-ln-code"><a href="#cb2-6"></a><span class="co"># ODE for SE, EI, IR transitions</span></span>
<span id="cb2-7" class="hljs-ln-code"><a href="#cb2-7"></a><span class="fu">odeSE</span>(; S, E, I, R, Np, σ, γ, β, Nloc) <span class="op">=</span> (β <span class="op">.*</span> I <span class="op">./</span> Np)</span>
<span id="cb2-8" class="hljs-ln-code"><a href="#cb2-8"></a><span class="fu">odeEI</span>(; S, E, I, R, Np, σ, γ, β, Nloc) <span class="op">=</span> σ</span>
<span id="cb2-9" class="hljs-ln-code"><a href="#cb2-9"></a><span class="fu">odeIR</span>(; S, E, I, R, Np, σ, γ, β, Nloc) <span class="op">=</span> γ</span>
<span id="cb2-10" class="hljs-ln-code"><a href="#cb2-10"></a><span class="co"># make transition functions from ODE</span></span>
<span id="cb2-11" class="hljs-ln-code"><a href="#cb2-11"></a>SE <span class="op">=</span> <span class="fu">makeTrans</span>(odeSE, <span class="op">:</span>S, <span class="op">:</span>E)</span>
<span id="cb2-12" class="hljs-ln-code"><a href="#cb2-12"></a>EI <span class="op">=</span> <span class="fu">makeTrans</span>(odeEI, <span class="op">:</span>E, <span class="op">:</span>I)</span>
<span id="cb2-13" class="hljs-ln-code"><a href="#cb2-13"></a>IR <span class="op">=</span> <span class="fu">makeTrans</span>(odeIR, <span class="op">:</span>I, <span class="op">:</span>R)</span>
<span id="cb2-14" class="hljs-ln-code"><a href="#cb2-14"></a>transitions <span class="op">=</span> [SE, EI, IR]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="code-demonstration-simulating-data-1" class="slide level2" data-auto-animate="true" data-visibility="uncounted">
<h2 data-id="quarto-animate-title">Code Demonstration: Simulating Data</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource julia number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode julia hljs"><span id="cb3-1" class="hljs-ln-code"><a href="#cb3-1"></a>Nt <span class="op">=</span> <span class="fl">365</span></span>
<span id="cb3-2" class="hljs-ln-code"><a href="#cb3-2"></a>Nloc <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb3-3" class="hljs-ln-code"><a href="#cb3-3"></a>N <span class="op">=</span> <span class="fl">50</span></span>
<span id="cb3-4" class="hljs-ln-code"><a href="#cb3-4"></a>M <span class="op">=</span> <span class="fl">50</span></span>
<span id="cb3-5" class="hljs-ln-code"><a href="#cb3-5"></a>p <span class="op">=</span> <span class="fl">3</span></span>
<span id="cb3-6" class="hljs-ln-code"><a href="#cb3-6"></a><span class="co"># ODE for SE, EI, IR transitions</span></span>
<span id="cb3-7" class="hljs-ln-code"><a href="#cb3-7"></a><span class="fu">odeSE</span>(; S, E, I, R, Np, σ, γ, β, Nloc) <span class="op">=</span> (β <span class="op">.*</span> I <span class="op">./</span> Np)</span>
<span id="cb3-8" class="hljs-ln-code"><a href="#cb3-8"></a><span class="fu">odeEI</span>(; S, E, I, R, Np, σ, γ, β, Nloc) <span class="op">=</span> σ</span>
<span id="cb3-9" class="hljs-ln-code"><a href="#cb3-9"></a><span class="fu">odeIR</span>(; S, E, I, R, Np, σ, γ, β, Nloc) <span class="op">=</span> γ</span>
<span id="cb3-10" class="hljs-ln-code"><a href="#cb3-10"></a><span class="co"># make transition functions from ODE</span></span>
<span id="cb3-11" class="hljs-ln-code"><a href="#cb3-11"></a>SE <span class="op">=</span> <span class="fu">makeTrans</span>(odeSE, <span class="op">:</span>S, <span class="op">:</span>E)</span>
<span id="cb3-12" class="hljs-ln-code"><a href="#cb3-12"></a>EI <span class="op">=</span> <span class="fu">makeTrans</span>(odeEI, <span class="op">:</span>E, <span class="op">:</span>I)</span>
<span id="cb3-13" class="hljs-ln-code"><a href="#cb3-13"></a>IR <span class="op">=</span> <span class="fu">makeTrans</span>(odeIR, <span class="op">:</span>I, <span class="op">:</span>R)</span>
<span id="cb3-14" class="hljs-ln-code"><a href="#cb3-14"></a>transitions <span class="op">=</span> [SE, EI, IR]</span>
<span id="cb3-15" class="hljs-ln-code"><a href="#cb3-15"></a>θ <span class="op">=</span> (; Np<span class="op">=</span><span class="fl">60000</span>, σ<span class="op">=</span><span class="fl">0.2</span>, γ<span class="op">=</span><span class="fl">0.1</span>, β<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb3-16" class="hljs-ln-code"><a href="#cb3-16"></a></span>
<span id="cb3-17" class="hljs-ln-code"><a href="#cb3-17"></a><span class="co"># set initial compartment values</span></span>
<span id="cb3-18" class="hljs-ln-code"><a href="#cb3-18"></a>compartments <span class="op">=</span> (S<span class="op">=</span><span class="fu">zeros</span>(<span class="dt">Float16</span>, nLoc) <span class="op">.+</span> <span class="fl">59990</span>,</span>
<span id="cb3-19" class="hljs-ln-code"><a href="#cb3-19"></a>    E<span class="op">=</span><span class="fu">zeros</span>(<span class="dt">Float16</span>, nLoc) <span class="op">+</span> <span class="fu">fill</span>(<span class="fl">0</span>, nLoc),</span>
<span id="cb3-20" class="hljs-ln-code"><a href="#cb3-20"></a>    I<span class="op">=</span><span class="fu">zeros</span>(<span class="dt">Float16</span>, nLoc) <span class="op">+</span> <span class="fu">fill</span>(<span class="fl">0</span>, nLoc),</span>
<span id="cb3-21" class="hljs-ln-code"><a href="#cb3-21"></a>    R<span class="op">=</span><span class="fu">zeros</span>(<span class="dt">Float16</span>, nLoc))</span>
<span id="cb3-22" class="hljs-ln-code"><a href="#cb3-22"></a>compartments[<span class="op">:</span>E][<span class="fl">1</span>] <span class="op">=</span> <span class="fl">3</span></span>
<span id="cb3-23" class="hljs-ln-code"><a href="#cb3-23"></a>compartments[<span class="op">:</span>I][<span class="fl">1</span>] <span class="op">=</span> <span class="fl">7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="code-demonstration-simulating-data-2" class="slide level2" data-auto-animate="true" data-visibility="uncounted">
<h2 data-id="quarto-animate-title">Code Demonstration: Simulating Data</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource julia number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode julia hljs"><span id="cb4-1" class="hljs-ln-code"><a href="#cb4-1"></a>Nt <span class="op">=</span> <span class="fl">365</span></span>
<span id="cb4-2" class="hljs-ln-code"><a href="#cb4-2"></a>Nloc <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb4-3" class="hljs-ln-code"><a href="#cb4-3"></a><span class="co"># ODE for SE, EI, IR transitions</span></span>
<span id="cb4-4" class="hljs-ln-code"><a href="#cb4-4"></a><span class="fu">odeSE</span>(; S, E, I, R, Np, σ, γ, β, Nloc) <span class="op">=</span> (β <span class="op">.*</span> I <span class="op">./</span> Np)</span>
<span id="cb4-5" class="hljs-ln-code"><a href="#cb4-5"></a><span class="fu">odeEI</span>(; S, E, I, R, Np, σ, γ, β, Nloc) <span class="op">=</span> σ</span>
<span id="cb4-6" class="hljs-ln-code"><a href="#cb4-6"></a><span class="fu">odeIR</span>(; S, E, I, R, Np, σ, γ, β, Nloc) <span class="op">=</span> γ</span>
<span id="cb4-7" class="hljs-ln-code"><a href="#cb4-7"></a><span class="co"># make transition functions from ODE</span></span>
<span id="cb4-8" class="hljs-ln-code"><a href="#cb4-8"></a>SE <span class="op">=</span> <span class="fu">makeTrans</span>(odeSE, <span class="op">:</span>S, <span class="op">:</span>E)</span>
<span id="cb4-9" class="hljs-ln-code"><a href="#cb4-9"></a>EI <span class="op">=</span> <span class="fu">makeTrans</span>(odeEI, <span class="op">:</span>E, <span class="op">:</span>I)</span>
<span id="cb4-10" class="hljs-ln-code"><a href="#cb4-10"></a>IR <span class="op">=</span> <span class="fu">makeTrans</span>(odeIR, <span class="op">:</span>I, <span class="op">:</span>R)</span>
<span id="cb4-11" class="hljs-ln-code"><a href="#cb4-11"></a>transitions <span class="op">=</span> [SE, EI, IR]</span>
<span id="cb4-12" class="hljs-ln-code"><a href="#cb4-12"></a>θ <span class="op">=</span> (; Np<span class="op">=</span><span class="fl">60000</span>, σ<span class="op">=</span><span class="fl">0.2</span>, γ<span class="op">=</span><span class="fl">0.1</span>, β<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb4-13" class="hljs-ln-code"><a href="#cb4-13"></a></span>
<span id="cb4-14" class="hljs-ln-code"><a href="#cb4-14"></a><span class="co"># set initial compartment values</span></span>
<span id="cb4-15" class="hljs-ln-code"><a href="#cb4-15"></a>compartments <span class="op">=</span> (S<span class="op">=</span><span class="fu">zeros</span>(<span class="dt">Float16</span>, nLoc) <span class="op">.+</span> <span class="fl">59990</span>,</span>
<span id="cb4-16" class="hljs-ln-code"><a href="#cb4-16"></a>    E<span class="op">=</span><span class="fu">zeros</span>(<span class="dt">Float16</span>, nLoc) <span class="op">+</span> <span class="fu">fill</span>(<span class="fl">0</span>, nLoc),</span>
<span id="cb4-17" class="hljs-ln-code"><a href="#cb4-17"></a>    I<span class="op">=</span><span class="fu">zeros</span>(<span class="dt">Float16</span>, nLoc) <span class="op">+</span> <span class="fu">fill</span>(<span class="fl">0</span>, nLoc),</span>
<span id="cb4-18" class="hljs-ln-code"><a href="#cb4-18"></a>    R<span class="op">=</span><span class="fu">zeros</span>(<span class="dt">Float16</span>, nLoc))</span>
<span id="cb4-19" class="hljs-ln-code"><a href="#cb4-19"></a>compartments[<span class="op">:</span>E][<span class="fl">1</span>] <span class="op">=</span> <span class="fl">3</span></span>
<span id="cb4-20" class="hljs-ln-code"><a href="#cb4-20"></a>compartments[<span class="op">:</span>I][<span class="fl">1</span>] <span class="op">=</span> <span class="fl">7</span></span>
<span id="cb4-21" class="hljs-ln-code"><a href="#cb4-21"></a></span>
<span id="cb4-22" class="hljs-ln-code"><a href="#cb4-22"></a><span class="co"># simulate and epidemic</span></span>
<span id="cb4-23" class="hljs-ln-code"><a href="#cb4-23"></a><span class="bu">Random</span>.<span class="fu">seed!</span>(<span class="fl">3453</span>)</span>
<span id="cb4-24" class="hljs-ln-code"><a href="#cb4-24"></a>simEp, simPar <span class="op">=</span> <span class="fu">simEpidemic</span>(Nt, θ, compartments, transitions, nLoc);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="code-demonstration-particle-filter" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Code Demonstration: Particle Filter</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource julia number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode julia hljs"><span id="cb5-1" class="hljs-ln-code"><a href="#cb5-1"></a><span class="co"># prepare "under-reported" cases</span></span>
<span id="cb5-2" class="hljs-ln-code"><a href="#cb5-2"></a>ysim <span class="op">=</span> [simEp[<span class="op">:</span>I][<span class="op">:</span>, t] for t <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">365</span>]</span>
<span id="cb5-3" class="hljs-ln-code"><a href="#cb5-3"></a>yobs <span class="op">=</span> <span class="fu">rand</span>.(<span class="fu">MultPoisson</span>.(ysim <span class="op">*</span> <span class="fl">0.5</span>));</span>
<span id="cb5-4" class="hljs-ln-code"><a href="#cb5-4"></a></span>
<span id="cb5-5" class="hljs-ln-code"><a href="#cb5-5"></a><span class="co"># add components for particle filter</span></span>
<span id="cb5-6" class="hljs-ln-code"><a href="#cb5-6"></a><span class="co">## measurement function</span></span>
<span id="cb5-7" class="hljs-ln-code"><a href="#cb5-7"></a><span class="kw">function</span> <span class="fu">g</span>(y, particles, changes, data, n, θ, θt, t, Nloc)</span>
<span id="cb5-8" class="hljs-ln-code"><a href="#cb5-8"></a>    μ <span class="op">=</span> particles[<span class="op">:</span>I][n, <span class="op">:</span>, t]</span>
<span id="cb5-9" class="hljs-ln-code"><a href="#cb5-9"></a>    <span class="fu">logpdf</span>.(<span class="fu">MultPoisson</span>.(μ), [y[t] <span class="op">.*</span> <span class="fl">2</span>])</span>
<span id="cb5-10" class="hljs-ln-code"><a href="#cb5-10"></a><span class="kw">end</span></span>
<span id="cb5-11" class="hljs-ln-code"><a href="#cb5-11"></a></span>
<span id="cb5-12" class="hljs-ln-code"><a href="#cb5-12"></a><span class="co"># priors/initial proposals</span></span>
<span id="cb5-13" class="hljs-ln-code"><a href="#cb5-13"></a>βprop <span class="op">=</span> <span class="fu">makeProposal</span>(<span class="fu">Gamma</span>(<span class="fl">4</span>, <span class="fl">0.05</span>), <span class="op">:</span>β)</span>
<span id="cb5-14" class="hljs-ln-code"><a href="#cb5-14"></a>σprop <span class="op">=</span> <span class="fu">makeProposal</span>(<span class="fu">Gamma</span>(<span class="fl">4</span>, <span class="fl">0.05</span>), <span class="op">:</span>σ)</span>
<span id="cb5-15" class="hljs-ln-code"><a href="#cb5-15"></a>γprop <span class="op">=</span> <span class="fu">makeProposal</span>(<span class="fu">Gamma</span>(<span class="fl">4</span>, <span class="fl">0.05</span>), <span class="op">:</span>γ)</span>
<span id="cb5-16" class="hljs-ln-code"><a href="#cb5-16"></a>proposals <span class="op">=</span> [βprop, σprop, γprop]</span>
<span id="cb5-17" class="hljs-ln-code"><a href="#cb5-17"></a></span>
<span id="cb5-18" class="hljs-ln-code"><a href="#cb5-18"></a><span class="co"># known parameters</span></span>
<span id="cb5-19" class="hljs-ln-code"><a href="#cb5-19"></a>θ <span class="op">=</span> (; Np<span class="op">=</span><span class="fl">60000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="code-demonstration-particle-filter-1" class="slide level2" data-auto-animate="true" data-visibility="uncounted">
<h2 data-id="quarto-animate-title">Code Demonstration: Particle Filter</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource julia number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode julia hljs"><span id="cb6-1" class="hljs-ln-code"><a href="#cb6-1"></a><span class="co"># add components for particle filter</span></span>
<span id="cb6-2" class="hljs-ln-code"><a href="#cb6-2"></a><span class="co">## measurement function</span></span>
<span id="cb6-3" class="hljs-ln-code"><a href="#cb6-3"></a><span class="kw">function</span> <span class="fu">g</span>(y, particles, changes, data, n, θ, θt, t, Nloc)</span>
<span id="cb6-4" class="hljs-ln-code"><a href="#cb6-4"></a>    μ <span class="op">=</span> particles[<span class="op">:</span>I][n, <span class="op">:</span>, t]</span>
<span id="cb6-5" class="hljs-ln-code"><a href="#cb6-5"></a>    <span class="fu">logpdf</span>.(<span class="fu">MultPoisson</span>.(μ), [y[t] <span class="op">.*</span> <span class="fl">2</span>])</span>
<span id="cb6-6" class="hljs-ln-code"><a href="#cb6-6"></a><span class="kw">end</span></span>
<span id="cb6-7" class="hljs-ln-code"><a href="#cb6-7"></a></span>
<span id="cb6-8" class="hljs-ln-code"><a href="#cb6-8"></a><span class="co"># priors/initial proposals</span></span>
<span id="cb6-9" class="hljs-ln-code"><a href="#cb6-9"></a>βprop <span class="op">=</span> <span class="fu">makeProposal</span>(<span class="fu">Gamma</span>(<span class="fl">4</span>, <span class="fl">0.05</span>), <span class="op">:</span>β)</span>
<span id="cb6-10" class="hljs-ln-code"><a href="#cb6-10"></a>σprop <span class="op">=</span> <span class="fu">makeProposal</span>(<span class="fu">Gamma</span>(<span class="fl">4</span>, <span class="fl">0.05</span>), <span class="op">:</span>σ)</span>
<span id="cb6-11" class="hljs-ln-code"><a href="#cb6-11"></a>γprop <span class="op">=</span> <span class="fu">makeProposal</span>(<span class="fu">Gamma</span>(<span class="fl">4</span>, <span class="fl">0.05</span>), <span class="op">:</span>γ)</span>
<span id="cb6-12" class="hljs-ln-code"><a href="#cb6-12"></a>proposals <span class="op">=</span> [βprop, σprop, γprop]</span>
<span id="cb6-13" class="hljs-ln-code"><a href="#cb6-13"></a></span>
<span id="cb6-14" class="hljs-ln-code"><a href="#cb6-14"></a><span class="co"># known parameters</span></span>
<span id="cb6-15" class="hljs-ln-code"><a href="#cb6-15"></a>θ <span class="op">=</span> (; Np<span class="op">=</span><span class="fl">60000</span>)</span>
<span id="cb6-16" class="hljs-ln-code"><a href="#cb6-16"></a></span>
<span id="cb6-17" class="hljs-ln-code"><a href="#cb6-17"></a>N <span class="op">=</span> <span class="fl">50</span></span>
<span id="cb6-18" class="hljs-ln-code"><a href="#cb6-18"></a>M <span class="op">=</span> <span class="fl">50</span></span>
<span id="cb6-19" class="hljs-ln-code"><a href="#cb6-19"></a>p <span class="op">=</span> <span class="fl">3</span></span>
<span id="cb6-20" class="hljs-ln-code"><a href="#cb6-20"></a><span class="co">## run hybrid particle filter</span></span>
<span id="cb6-21" class="hljs-ln-code"><a href="#cb6-21"></a>out <span class="op">=</span> <span class="fu">pf_hybrid2</span>(yobs, N, M, θ, g, compartments, transitions, proposals; p<span class="op">=</span>p)</span>
<span id="cb6-22" class="hljs-ln-code"><a href="#cb6-22"></a>Iest <span class="op">=</span> <span class="fu">getstate</span>(out[<span class="fl">1</span>], <span class="op">:</span>I, <span class="fl">1</span>, out[<span class="fl">4</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="code-demonstration-particle-filter-2" class="slide level2" data-auto-animate="true" data-visibility="uncounted">
<h2 data-id="quarto-animate-title">Code Demonstration: Particle Filter</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource julia number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode julia hljs"><span id="cb7-1" class="hljs-ln-code"><a href="#cb7-1"></a><span class="co"># add components for particle filter</span></span>
<span id="cb7-2" class="hljs-ln-code"><a href="#cb7-2"></a><span class="co">## measurement function</span></span>
<span id="cb7-3" class="hljs-ln-code"><a href="#cb7-3"></a><span class="kw">function</span> <span class="fu">g</span>(y, particles, changes, data, n, θ, θt, t, Nloc)</span>
<span id="cb7-4" class="hljs-ln-code"><a href="#cb7-4"></a>    μ <span class="op">=</span> particles[<span class="op">:</span>I][n, <span class="op">:</span>, t]</span>
<span id="cb7-5" class="hljs-ln-code"><a href="#cb7-5"></a>    <span class="fu">logpdf</span>.(<span class="fu">MultPoisson</span>.(μ), [y[t] <span class="op">.*</span> <span class="fl">2</span>])</span>
<span id="cb7-6" class="hljs-ln-code"><a href="#cb7-6"></a><span class="kw">end</span></span>
<span id="cb7-7" class="hljs-ln-code"><a href="#cb7-7"></a></span>
<span id="cb7-8" class="hljs-ln-code"><a href="#cb7-8"></a><span class="co"># priors/initial proposals</span></span>
<span id="cb7-9" class="hljs-ln-code"><a href="#cb7-9"></a>βprop <span class="op">=</span> <span class="fu">makeProposal</span>(<span class="fu">Gamma</span>(<span class="fl">4</span>, <span class="fl">0.05</span>), <span class="op">:</span>β)</span>
<span id="cb7-10" class="hljs-ln-code"><a href="#cb7-10"></a>σprop <span class="op">=</span> <span class="fu">makeProposal</span>(<span class="fu">Gamma</span>(<span class="fl">4</span>, <span class="fl">0.05</span>), <span class="op">:</span>σ)</span>
<span id="cb7-11" class="hljs-ln-code"><a href="#cb7-11"></a>γprop <span class="op">=</span> <span class="fu">makeProposal</span>(<span class="fu">Gamma</span>(<span class="fl">4</span>, <span class="fl">0.05</span>), <span class="op">:</span>γ)</span>
<span id="cb7-12" class="hljs-ln-code"><a href="#cb7-12"></a>proposals <span class="op">=</span> [βprop, σprop, γprop]</span>
<span id="cb7-13" class="hljs-ln-code"><a href="#cb7-13"></a></span>
<span id="cb7-14" class="hljs-ln-code"><a href="#cb7-14"></a><span class="co"># known parameters</span></span>
<span id="cb7-15" class="hljs-ln-code"><a href="#cb7-15"></a>θ <span class="op">=</span> (; Np<span class="op">=</span><span class="fl">60000</span>)</span>
<span id="cb7-16" class="hljs-ln-code"><a href="#cb7-16"></a></span>
<span id="cb7-17" class="hljs-ln-code"><a href="#cb7-17"></a>N <span class="op">=</span> <span class="fl">50</span></span>
<span id="cb7-18" class="hljs-ln-code"><a href="#cb7-18"></a>M <span class="op">=</span> <span class="fl">50</span></span>
<span id="cb7-19" class="hljs-ln-code"><a href="#cb7-19"></a>p <span class="op">=</span> <span class="fl">3</span></span>
<span id="cb7-20" class="hljs-ln-code"><a href="#cb7-20"></a><span class="co">## run hybrid particle filter</span></span>
<span id="cb7-21" class="hljs-ln-code"><a href="#cb7-21"></a>out <span class="op">=</span> <span class="fu">pf_hybrid2</span>(yobs, N, M, θ, g, compartments, transitions, proposals; p<span class="op">=</span>p)</span>
<span id="cb7-22" class="hljs-ln-code"><a href="#cb7-22"></a>Iest <span class="op">=</span> <span class="fu">getstate</span>(out[<span class="fl">1</span>], <span class="op">:</span>I, <span class="fl">1</span>, out[<span class="fl">4</span>])</span>
<span id="cb7-23" class="hljs-ln-code"><a href="#cb7-23"></a></span>
<span id="cb7-24" class="hljs-ln-code"><a href="#cb7-24"></a><span class="co"># plot results </span></span>
<span id="cb7-25" class="hljs-ln-code"><a href="#cb7-25"></a><span class="fu">plot</span>([simEp[<span class="op">:</span>I][<span class="fl">1</span>, <span class="op">:</span>], Iest, <span class="fu">first</span>.(yobs)], color<span class="op">=</span>[<span class="op">:</span>red <span class="op">:</span>dodgerblue2 <span class="op">:</span>green], label<span class="op">=</span>[<span class="st">"Truth"</span> <span class="st">"Estimate"</span> <span class="st">"Observed"</span>], legend<span class="op">=:</span>outertopright)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="code-demonstration-particle-filter-3" class="slide level2" data-auto-animate="true" data-visibility="uncounted">
<h2 data-id="quarto-animate-title">Code Demonstration: Particle Filter</h2>
<div id="fig-539a35d47e664c97a50115a146a7f1bd-8" class="quarto-figure quarto-figure-center" height="400" width="650">
<figure class="quarto-float quarto-float-fig">
<div>
<img data-src="demo_I.png" id="fig-539a35d47e664c97a50115a146a7f1bd-8" width="650" height="400">
</div>
</figure>
</div>
</section>
<section id="discussion-and-conclusions" class="slide level2">
<h2>Discussion and Conclusions</h2>
<ul>
<li><p>The Hybrid Particle Filter offers a computationally efficient approach to the simultaneous estimation problem.</p>
<ul>
<li><p>Does not perform well with flat priors.</p></li>
<li><p>Fast relative to MCMC but generally slower than the Nested Particle Filter.</p></li>
</ul></li>
</ul>
<div class="fragment">
<ul>
<li>Alternative resampling schemes should be explored.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><p>Potential for two-stage estimation approaches</p>
<ul>
<li><p>Results from the Hybrid algorithm could be used as a “hot start” for MCMC</p></li>
<li><p>Results from the Nested Particle Filter can be used to construct weakly informative priors for the Hybrid Particle Filter.</p></li>
</ul></li>
</ul>
</div>
</section>
<section id="contributions" class="slide level2">
<h2>Contributions</h2>
<ol type="1">
<li>We have introduced a novel particle filtering algorithm: the Hybrid Particle Filter.</li>
</ol>
<ul>
<li>Enables efficient simultaneous estimation of latent states and unknown parameters.</li>
</ul>
<div class="fragment">
<ol start="2" type="1">
<li>We have developed a software package in Julia.</li>
</ol>
<ul>
<li>Offers a convenient, accessible, and customizeable way for researchers to use our algorithm under any compartmental model structure.</li>
</ul>
</div>
<div class="fragment">
<ol start="3" type="1">
<li>We constructed a fully stochastic, spatially explicit model for a cholera outbreak in Haiti</li>
</ol>
<ul>
<li>Other researchers have been limited to two stage, partially stocahstic models.</li>
</ul>
</div>
<div class="fragment">
<p>Our novel algorithm and accompanying custom software package have the potential to make complex state space modeling more accessbile and more efficient.</p>
</div>
</section>
<section id="acknowledgements" class="slide level2">
<h2>Acknowledgements</h2>
<ul>
<li><p>Thesis and RA advisor, Dr.&nbsp;Grant Brown</p></li>
<li><p>Committee members, Dr.&nbsp;Emily Roberts, Dr.&nbsp;Daniel Sewell, and Dr.&nbsp;Brian Smith</p></li>
<li><p>University of Iowa Biostatistics Department faculty, staff, and students</p></li>
</ul>
<div class="fragment">
<ul>
<li>Friends, family, and cats</li>
</ul>
<div id="fig-539a35d47e664c97a50115a146a7f1bd-9" class="absolute quarto-figure quarto-figure-center" height="420" width="420" data-bottom="0" data-right="40" style="bottom: 0px; right: 40px; width: 420px; height: 420px; ">
<figure class="quarto-float quarto-float-fig">
<div>
<img data-src="cats.png" id="fig-539a35d47e664c97a50115a146a7f1bd-9" class="absolute" style="bottom: 0px; right: 40px; width: 420px; height: 420px; ">
</div>
</figure>
</div>
</div>
</section>
<section id="questions" class="slide level2">
<h2>Questions?</h2>
<div id="fig-539a35d47e664c97a50115a146a7f1bd-10" class="quarto-figure quarto-figure-center" height="550" width="530">
<figure class="quarto-float quarto-float-fig">
<div>
<img data-src="questions.jpeg" id="fig-539a35d47e664c97a50115a146a7f1bd-10" width="530" height="550">
</div>
</figure>
</div>
</section>
<section id="appendix-particle-filters" class="slide level2" data-visibility="uncounted">
<h2>Appendix: Particle Filters</h2>
<p>Estimation occurs in two steps:</p>
<ol type="1">
<li><p><strong>Predict</strong>: Compute the prior <span class="math inline">\(p(x_t | y_{1:t-1}) = \int p(x_t | x_{t-1}) p(x_{t-1} | y_{1:t-1}) dx_{t-1}\)</span></p></li>
<li><p><strong>Update</strong>: Use the prior from step 1 to obtain a posterior estimate <span class="math inline">\(p(x_t | y_{1:t})\)</span></p></li>
</ol>
<p><span class="math display">\[p(x_t | y_{1:t}) = \frac{p(y_t | x_t) p(x_t | y_{1:t-1})}{\int p(y_t | x_t) p(x_t | y_{1:t-1})dx_t}\]</span></p>
<div class="fragment">
<p>However, analytical evaluation of steps 1 and 2 is often impossible and an approximation is required.</p>
<ul>
<li>Approximate the continuous pdf with a weighted sum of <span class="math inline">\(N_s\)</span> potential realizations of the true state with <span class="math inline">\(p(x_{0:t}| y_{1:t}) \approx \sum_{i=1}^{N_s} w_{t}^{i} \delta (x_{0:t} - x_{0:t}^i)\)</span></li>
</ul>
</div>
</section>
<section id="appendix-weight-calculation" class="slide level2" data-visibility="uncounted">
<h2>Appendix: Weight Calculation</h2>
<p><span class="math display">\[\begin{align}
    \label{eq:weightDeriv}
    p(x_{0:t}|y_{1:t}) &amp;= \frac{p(y_{t}|x_{0:t}|y_{1:t-1}) p(x_{0:t}|y_{1:t-1})}{p(y_t | y_{1:t-1})} \\
    &amp;= \frac{p(y_{t}|x_{0:t}|y_{1:t-1}) p(x_{t}|x_{0:t-1}|y_{1:t-1})}{p(y_t | y_{1:t-1})} \times p(x_{0:t-1}|y_{1:t-1}) \\
    &amp;= \frac{p(y_t|x_t) p(x_t|x_{t-1})}{p(y_t|y_{1:t-1})} \times p(x_{0:t-1}|y_{1:t-1}) \\
    &amp;\propto p(y_t | x_t) p(x_t|x_{t-1}) p(x_{0:t-1}|y_{1:t-1})
\end{align}\]</span></p>
<p>Note that importance weights are calculated by taking a ratio of the posterior and the importance density for each particle:</p>
<p><span class="math display">\[\begin{equation}
\label{eq:impwt}
    w_t^i \propto \frac{p(x_{0:t}^i | y_{1:t})}{q(x_{0:t}^i | y_{1:t})}
\end{equation}\]</span></p>
<p>Finally,</p>
<p><span class="math display">\[\begin{align}
    \label{eq:wtsub}
    w_t^i &amp;\propto \frac{p(x_{0:t}^i|y_{1:t})}{q(x_t^i|x_{0:t-1}^i, y_{1:t}) q(x_{0:t-1}^i|y_{1:t-1})} \nonumber \\
    &amp;= \frac{p(y_t | x_t) p(x_t|x_{t-1}) p(x_{0:t-1}|y_{1:t-1})}{q(x_t^i|x_{0:t-1}^i, y_{1:t}) q(x_{0:t-1}^i|y_{1:t-1})} \nonumber \\
    &amp;= w_{t-1}^i \frac{p(y_t|x_t^i) p(x_t^i | x_{t-1}^i)}{q(x_t^i|x_{0:t-1}^i, y_{1:t})} \nonumber \\
    &amp;= w_{t-1}^i \frac{p(y_t|x_t^i) p(x_t^i | x_{t-1}^i)}{q(x_t^i|x_{t-1}^i, y_t)}
\end{align}\]</span></p>
</section>
<section id="appendix-nested-pf-balance-heuristic" class="slide level2" data-visibility="uncounted">
<h2>Appendix: Nested PF Balance Heuristic</h2>
<ul>
<li><p>In the Nested Particle Filter, there are <span class="math inline">\(N\)</span> combined estimators, each of which combines <span class="math inline">\(M\)</span> samples with <span class="math inline">\(c_i = \frac{1}{M}\)</span> using the balance heuristic.</p></li>
<li><p><span class="math inline">\(\{ X_t^{(i)}\}_{i=1}^N\)</span> outer particles and <span class="math inline">\(\{ X_t^{(i,j)}\}_{j=1}^M\)</span> inner particles</p></li>
<li><p><span class="math inline">\(\{ X_t^{(i,j)}\} \sim p(y_t | x_t^{(i)})\)</span></p></li>
<li><p><span class="math inline">\(w_t^{(i)} = \frac{1}{M} \sum_{j=1}^M \frac{p(y_t | x_t^{(i, j)})}{p(x_t^{(i)})}\)</span></p></li>
</ul>

<img src="IOWA-logo.png" class="slide-logo r-stretch"><div class="footer footer-default">
<p>A Hybrid Particle Filter</p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="thesis-defense_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="thesis-defense_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="thesis-defense_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="thesis-defense_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="thesis-defense_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="thesis-defense_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="thesis-defense_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="thesis-defense_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="thesis-defense_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="thesis-defense_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="thesis-defense_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true,"theme":"whiteboard"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>